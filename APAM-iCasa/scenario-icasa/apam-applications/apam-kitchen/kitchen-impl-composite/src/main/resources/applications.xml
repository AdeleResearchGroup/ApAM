<apam xmlns="fr.imag.adele.apam" xmlns:ipojo="org.apache.felix.ipojo">
	<!-- *********** ************ -->
	<!--   Kitchen App Composite  -->
	<!-- *********** ************ -->
	<composite name="KitchenAppComposite" specification="KitchenApp"
		mainImplem="KitchenApp-Impl">

		<owns component="Microwave">
			<constraints>
				<instance filter="(location=kitchen)" />
			</constraints>
		</owns>
		<owns component="Oven">
			<constraints>
				<instance filter="(location=kitchen)" />
			</constraints>
		</owns>
	</composite>


	<!-- *********** ************ -->
	<!--        Instance         -->
	<!-- *********** ************ -->

	<apam-instance implementation="KitchenAppComposite"
		name="KitchenAppComposite-Instance" />



	<specification name="KitchenApp"
		interfaces="fr.imag.adele.apam.application.kitchen.KitchenApp"
		messages="fr.imag.adele.apam.application.kitchen.KitchenMessage">

		<dependency specification="Microwave" />
		<dependency specification="Oven" />
	</specification>
<implementation name="KitchenApp-Impl"
		classname="fr.imag.adele.apam.application.kitchen.impl.KitchenAppImpl"
		interfaces="fr.imag.adele.apam.application.kitchen.KitchenApp"
		messages="fr.imag.adele.apam.application.kitchen.KitchenMessage"
		specification="KitchenApp" message-fields="sendKitchenMessage">
       
		<dependency specification="Microwave">
			<interface field="microwave" />
			<message method="consumeMicrowaveMessage" />
			<constraints>
				<instance filter="(location=kitchen)" />
			</constraints>
		</dependency>
		<dependency specification="Oven">
			<interface field="oven" />
			<message method="consumeOvenMessage" />
			<constraints>
				<instance filter="(location=kitchen)" />
			</constraints>
		</dependency>
	</implementation>

	<!-- L'ideal  est de supprimer la mainImplem-->
	<composite name="MediaCenter" mainImplem="MediaPlayer-Impl">

		<owns component="TvScreen">
			<constraints>
				<constraint filter="(location=livingroom)" />
			</constraints>
		</owns>
		<owns component="Speaker">
			<constraints>
				<constraint filter="(location=livingroom)" />
			</constraints>
		</owns>
	</composite>

	<!-- *********** *************** -->
	<!-- Media center App           -->
	<!-- *********** ************ -->


	<implementation name="MediaPlayer-Impl"
		classname="fr.imag.adele.apam.application.mediacenter.impl.MediaPayerImpl"
		specification="MediaPlayer">
		<dependency specification="TvScreen">
			<interface field="tvScreen" />
		</dependency>
		<dependency specification="Speaker">
			<interface field="speaker" />
		</dependency>
	</implementation>
	
		<specification name="MediaPlayer"
		interfaces="fr.imag.adele.apam.application.mediacenter.MediaPlayer">
		<dependency specification="Speaker">
			<constraints>
				<instance filter="(location=livingroom)" />
			</constraints>
		</dependency>
		<dependency specification="TvScreen">
			<constraints>
				<instance filter="(location=livingroom)" />
			</constraints>
		</dependency>
	</specification>
	
</apam>